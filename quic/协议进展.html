<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>协议进展 | HTTP/3详解</title>
    <meta name="description" content="同步最新版本">
    
    
    <link rel="preload" href="/HTTP3-explained/assets/css/0.styles.98c7e493.css" as="style"><link rel="preload" href="/HTTP3-explained/assets/js/app.6f93dde3.js" as="script"><link rel="preload" href="/HTTP3-explained/assets/js/2.af288cb7.js" as="script"><link rel="preload" href="/HTTP3-explained/assets/js/12.bb52108a.js" as="script"><link rel="prefetch" href="/HTTP3-explained/assets/js/10.7285fa45.js"><link rel="prefetch" href="/HTTP3-explained/assets/js/11.e24adbcd.js"><link rel="prefetch" href="/HTTP3-explained/assets/js/13.e4b908f8.js"><link rel="prefetch" href="/HTTP3-explained/assets/js/14.1d694c15.js"><link rel="prefetch" href="/HTTP3-explained/assets/js/15.ca7c5b3a.js"><link rel="prefetch" href="/HTTP3-explained/assets/js/16.2c33a42e.js"><link rel="prefetch" href="/HTTP3-explained/assets/js/3.516edb88.js"><link rel="prefetch" href="/HTTP3-explained/assets/js/4.681057c4.js"><link rel="prefetch" href="/HTTP3-explained/assets/js/5.c29567e7.js"><link rel="prefetch" href="/HTTP3-explained/assets/js/6.9f0cfbad.js"><link rel="prefetch" href="/HTTP3-explained/assets/js/7.95377356.js"><link rel="prefetch" href="/HTTP3-explained/assets/js/8.05294efb.js"><link rel="prefetch" href="/HTTP3-explained/assets/js/9.4d835814.js">
    <link rel="stylesheet" href="/HTTP3-explained/assets/css/0.styles.98c7e493.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/HTTP3-explained/" class="home-link router-link-active"><!----> <span class="site-name">HTTP/3详解</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/HTTP3-explained/" class="nav-link">首页</a></div><div class="nav-item"><a href="https://github.com/Geekhyt" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/HTTP3-explained/" class="nav-link">首页</a></div><div class="nav-item"><a href="https://github.com/Geekhyt" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/HTTP3-explained/quic/引言.html" class="sidebar-link">引言</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/HTTP3-explained/quic/为什么需要QUIC.html" class="sidebar-link">为什么需要QUIC</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/为什么需要QUIC.html#回顾http-2" class="sidebar-link">回顾HTTP/2</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/为什么需要QUIC.html#tcp队头阻塞" class="sidebar-link">TCP队头阻塞</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/为什么需要QUIC.html#用tcp还是udp" class="sidebar-link">用TCP还是UDP</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/为什么需要QUIC.html#协议僵化" class="sidebar-link">协议僵化</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/为什么需要QUIC.html#安全性" class="sidebar-link">安全性</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/为什么需要QUIC.html#减少延迟" class="sidebar-link">减少延迟</a></li></ul></li><li><a href="/HTTP3-explained/quic/协议进展.html" class="active sidebar-link">协议进展</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/协议进展.html#iefe" class="sidebar-link">IEFE</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/协议进展.html#http-2的经验" class="sidebar-link">HTTP/2的经验</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/协议进展.html#标准化进展情况" class="sidebar-link">标准化进展情况</a></li></ul></li><li><a href="/HTTP3-explained/quic/协议特点.html" class="sidebar-link">协议特点</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/协议特点.html#基于udp" class="sidebar-link">基于UDP</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/协议特点.html#可靠性" class="sidebar-link">可靠性</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/协议特点.html#数据流" class="sidebar-link">数据流</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/协议特点.html#有序交付" class="sidebar-link">有序交付</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/协议特点.html#快速握手" class="sidebar-link">快速握手</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/协议特点.html#tls-1-3" class="sidebar-link">TLS 1.3</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/协议特点.html#传输层与应用层协议" class="sidebar-link">传输层与应用层协议</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/协议特点.html#quic之上的http协议" class="sidebar-link">QUIC之上的HTTP协议</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/协议特点.html#quic之上的非http协议" class="sidebar-link">QUIC之上的非HTTP协议</a></li></ul></li><li><a href="/HTTP3-explained/quic/QUIC工作原理.html" class="sidebar-link">QUIC工作原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/QUIC工作原理.html#连接" class="sidebar-link">连接</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/QUIC工作原理.html#使用tls的连接" class="sidebar-link">使用TLS的连接</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/QUIC工作原理.html#数据流" class="sidebar-link">数据流</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/QUIC工作原理.html#_0-rtt" class="sidebar-link">0-RTT</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/QUIC工作原理.html#旋转比特位" class="sidebar-link">旋转比特位</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/QUIC工作原理.html#用户空间实现" class="sidebar-link">用户空间实现</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/QUIC工作原理.html#api" class="sidebar-link">API</a></li></ul></li><li><a href="/HTTP3-explained/quic/HTTP3.html" class="sidebar-link">HTTP3</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/HTTP3.html#https-url" class="sidebar-link">HTTPS:// URL</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/HTTP3.html#使用alt-svc自举" class="sidebar-link">使用Alt-svc自举</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/HTTP3.html#quic流与http-3" class="sidebar-link">QUIC流与HTTP/3</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/HTTP3.html#优先度" class="sidebar-link">优先度</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/HTTP3.html#服务器推送" class="sidebar-link">服务器推送</a></li><li class="sidebar-sub-header"><a href="/HTTP3-explained/quic/HTTP3.html#与http-2的比较" class="sidebar-link">与HTTP/2的比较</a></li></ul></li><li><a href="/HTTP3-explained/quic/常见批评.html" class="sidebar-link">常见批评</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/HTTP3-explained/quic/技术标准.html" class="sidebar-link">技术标准</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/HTTP3-explained/quic/QUIC v2.html" class="sidebar-link">QUIC v2</a><ul class="sidebar-sub-headers"></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="协议进展"><a href="#协议进展" class="header-anchor">#</a> 协议进展</h1> <p>最初的QUIC协议是由Google的Jim Roskind设计的并于2012年实施的，在Google的扩大范围实验后，于2013年向全世界公开宣布。</p> <p>那时的QUIC还是“快速UDP互联网连接”（Quick UDP Internet Connections）的缩写，但现在已经不是了。</p> <p>Google实现了QUIC协议，并随后将它部署在其广泛流行的浏览器（Chrome）和最流行的服务（搜索、Gmail、YouTube等等）中。他们相当快地迭代该协议的版本，并且随着时间的流逝，他们证明了该协议可以面向大量的用户提供可靠的运作。</p> <p>2015年6月，QUIC的第一个互联网草案被提交到IETF进行标准化，但是直到2016年底，QUIC工作组才获得批准并开始工作。但随后，它立即引起了多方的高度关注。</p> <p>在2017年，据Google的QUIC工程师称，整个互联网中大约有7%的流量在使用该协议（Google版本）。</p> <h2 id="iefe"><a href="#iefe" class="header-anchor">#</a> IEFE</h2> <p>IETF为QUIC标准化成立的QUIC工作组很快作出决定，IETF标准化的QUIC协议应该支持除HTTP以外的其他协议。Google版的QUIC只传输HTTP--在实践中，它使用HTTP/2的帧语法传输了有效的HTTP/2帧。</p> <p>另外还指出，IETF-QUIC应该基于TLS 1.3而不是Google-QUIC使用的“自定义”方法来建立其加密和安全性。</p> <p>为了满足HTTP以外的需求，IETF QUIC协议体系结构分为两个单独的层：传输层QUIC和“基于QUIC的HTTP”(HTTP over QUIC)层(有时候缩写为“hq”)。</p> <p>尽管听起来可能是绿色无害的，但这一层的拆分已导致IETF-QUIC与原始Google-QUIC有很大不同。</p> <p>工作组很快便察觉到这一点，为了保持适当关注和按时交付第一版QUIC，工作组专注于交付HTTP，将非HTTP的传输留给以后的工作。</p> <p>我们在2018年3月开始编写本书，那时的计划是在2018年11月发布第一版QUIC的最终规范，不过后来推迟到2019年7月。</p> <p>在有关IETF-QUIC的工作取得了进展的同时，谷歌团队已整合了IETF版本的详细信息，并开始逐步将其协议版本发展为IETF版本。
谷歌仍继续在其浏览器和服务中使用自己的QUIC版本。</p> <p><a href="https://github.com/quicwg/base-drafts/wiki/Implementations" target="_blank" rel="noopener noreferrer">正在开发的大多数新实现<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>已将重点放在IETF版本上，并且与Google版本不兼容。</p> <h2 id="http-2的经验"><a href="#http-2的经验" class="header-anchor">#</a> HTTP/2的经验</h2> <p>HTTP/2规范RFC 7540于2015年5月发布，比QUIC首次引入IETF仅一个月的时间。</p> <p>使用HTTP/2奠定了通过网络更改HTTP的基础，并且创建HTTP/2的工作组已经有了这样的经验：迭代更新的HTTP版本会比从第一版到第二版快得多(约16年)。</p> <p>随着HTTP/2的发展，用户和软件协议栈不再以假定HTTP是一个以串行方式使用基于文本的协议。</p> <p>HTTP-over-QUIC于2018年11月重命名为HTTP/3。</p> <h2 id="标准化进展情况"><a href="#标准化进展情况" class="header-anchor">#</a> 标准化进展情况</h2> <p>QUIC工作组自2016年底以来一直在努力制定协议，现在计划在2019年7月之前完成工作。</p> <p>截止至2018年11月，仍然没有使用HTTP/3进行过大型的互操作性测试--仅有的两种实现方式，还不是通过浏览器或是主流的开源服务器软件来完成的。</p> <p>QUIC工作组的Wiki页面上列出了15种左右的QUIC实现，但是它们距离在最新的规范草案修订版上互操作还有很远的距离。</p> <p>实施QUIC并非易事，直到今天该协议仍在不断发展和变化。</p> <h3 id="服务器"><a href="#服务器" class="header-anchor">#</a> 服务器</h3> <p>NGINX对QUIC和HTTP/3的支持正在开发中。它计划在NGINX 1.17开发周期中发布。</p> <p>关于Apache对QUIC的支持，还没有公开声明。</p> <h3 id="客户端"><a href="#客户端" class="header-anchor">#</a> 客户端</h3> <p>尚未有任何大型浏览器供应商在任何状态下提供可以运行IETF版本QUIC或HTTP/3的任何版本。</p> <p>多年以来，谷歌浏览器一直在提供谷歌自己的QUIC版本的有效实施，但是它无法与IETF QUIC协议互操作，并且它的HTTP实施不同于HTTP/3。</p> <p>Mozilla正在开发<a href="https://github.com/mozilla/neqo/" target="_blank" rel="noopener noreferrer">Neqo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>--用<a href="https://www.rust-lang.org" target="_blank" rel="noopener noreferrer">Rust<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>编写的QUIC和HTTP/3的实现。<a href="https://github.com/mozilla/neqo/issues/10" target="_blank" rel="noopener noreferrer">计划将Neqo集成到<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Projects/Necko" target="_blank" rel="noopener noreferrer">Necko<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>(这是许多基于Mozilla的客户端应用程序，包括Firefox中使用的网络库)。</p> <p>curl在2019年9月11日发布了7.66.0版本中的第一个实验性HTTP/3支持(draft-22)。curl使用Cloudflare的Quiche库或ngtcp2系列库来完成工作。</p> <h3 id="实现的障碍"><a href="#实现的障碍" class="header-anchor">#</a> 实现的障碍</h3> <p>为了避免重复造轮子，以及依靠可信赖的现有协议，QUIC决定使用TLS 1.3作为它的加密和安全协议层。与此同时，工作组还决定要简化QUIC中TLS的使用，只使用“TLS信息”(TLS Messages)而不是协议中的“TLS记录”(TLS Records)。</p> <p>这听上去可能是绿色无害的更改，但实际上对许多的QUIC协议栈实现者造成了重大的障碍。现有的支持TLS 1.3的TLS库根本没有足够的API来公开此功能并允许QUIC访问它。虽然一些QUIC实施者来自大型组织，这些组织并行处理自己的TLS协议栈，但并非每个人都如此。</p> <p>例如，占主导地位的开源重量级OpenSSL对此没有任何API。解决这个问题的计划似乎在它们的<a href="https://github.com/openssl/openssl/pull/8797" target="_blank" rel="noopener noreferrer">PR 8797<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>中，该PR 8797的目的是引入一种与BoringSSL非常相似的API。</p> <p>这最终将成为QUIC协议栈部署的障碍。因为QUIC要么选择基于其他TLS库，要么使用补丁版的OpenSSL或者等待OpenSSL版本更新。</p> <h3 id="操作系统内核和cpu负载"><a href="#操作系统内核和cpu负载" class="header-anchor">#</a> 操作系统内核和CPU负载</h3> <p>Google和Facebook都提到，他们的QUIC大规模部署所需的CPU数量大约是通过TLS提供HTTP/2时相同流量负载所需要的CPU数量的两倍。</p> <p>对此的一些解释包括：</p> <ul><li><p>主要是Linux中的UDP部分根本没有像TCP协议栈那样优化，因为传统上它没有像这样被用于高速传输。</p></li> <li><p>TCP和TLS有硬件加速，而这对于UDP很罕见，对于QUIC而言则基本不存在。</p></li></ul> <p>我们有理由相信性能和CPU的要求会随着时间的推移而得到改善。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/HTTP3-explained/quic/为什么需要QUIC.html" class="prev">为什么需要QUIC</a></span> <span class="next"><a href="/HTTP3-explained/quic/协议特点.html">协议特点</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/HTTP3-explained/assets/js/app.6f93dde3.js" defer></script><script src="/HTTP3-explained/assets/js/2.af288cb7.js" defer></script><script src="/HTTP3-explained/assets/js/12.bb52108a.js" defer></script>
  </body>
</html>
